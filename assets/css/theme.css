/* Theme layer: background ambience and glassmorphism */
@layer theme {
  /* Ambient background for glassmorphism depth */
  body::before {
    content: "";
    position: fixed;
    inset: 0;
    z-index: -1;
    background:
      radial-gradient(900px 600px at 10% 20%, rgba(124, 58, 237, 0.24), transparent 60%),
      radial-gradient(800px 500px at 90% 10%, rgba(79, 70, 229, 0.20), transparent 65%),
      radial-gradient(700px 550px at 30% 100%, rgba(236, 72, 153, 0.18), transparent 60%),
      radial-gradient(700px 500px at 70% 85%, rgba(16, 185, 129, 0.15), transparent 60%),
      linear-gradient(180deg, #11172b 0%, #0b1020 100%);
    background-attachment: fixed;
  }

  /* Subtle animated highlight to add depth */
  body::after {
    content: "";
    position: fixed;
    inset: 0;
    z-index: -1;
    background: conic-gradient(from 0deg at 70% 30%, rgba(255,255,255,0.18), transparent 20%, rgba(255,255,255,0.16) 40%, transparent 60%, rgba(255,255,255,0.18) 80%, transparent 100%);
    mix-blend-mode: overlay;
    opacity: .10;
    animation: aurora-spin 220s linear infinite;
    pointer-events: none;
  }

  @keyframes aurora-spin {
    to { transform: rotate(360deg); }
  }

  @media (prefers-reduced-motion: reduce) {
    body::after { animation: none; }
  }

  /* Glassmorphism panels applied to key UI containers (dark glass) */
  @supports ((-webkit-backdrop-filter: blur(1px)) or (backdrop-filter: blur(1px))) {
    .nav__inner,
    .searchbar__row,
    .filters-panel,
    .panel,
    .glass-panel,
    .event-card,
    .cta__inner,
    .about__inner {
      background: rgba(17, 24, 39, 0.78);
      border: 1px solid rgba(255, 255, 255, 0.12);
      -webkit-backdrop-filter: blur(14px) saturate(140%);
      backdrop-filter: blur(14px) saturate(140%);
    }
    /* Keep sheet neutral/dark to match site */
    .sheet { background: transparent; border: none; box-shadow: none; }
    .sheet .panel { background: rgba(17, 24, 39, 0.78); border-color: rgba(255, 255, 255, 0.12); }
    .sheet .event-preview { background: rgba(17,24,39,0.78); border-color: rgba(255,255,255,0.12); }
    .modal__dialog {
      background: rgba(17, 24, 39, 0.86);
      border: 1px solid rgba(255, 255, 255, 0.12);
      -webkit-backdrop-filter: blur(18px) saturate(140%);
      backdrop-filter: blur(18px) saturate(140%);
    }
    /* Sidebar glass */
    .sidebar {
      background: rgba(17, 24, 39, 0.78);
      border-left: 1px solid rgba(255, 255, 255, 0.08);
      -webkit-backdrop-filter: blur(18px) saturate(140%);
      backdrop-filter: blur(18px) saturate(140%);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
    }
    /* Only glass the dropdown panel on mobile */
    @media (max-width: 768px) {
      .nav__links {
        background: rgba(255, 255, 255, 0.65);
        border: 1px solid rgba(255, 255, 255, 0.35);
        -webkit-backdrop-filter: blur(14px) saturate(140%);
        backdrop-filter: blur(14px) saturate(140%);
      }
    }
  }

  /* Cupertino theme override */
  body[data-theme="cupertino"] {
    --accent: #0a84ff; /* iOS blue */
    --accent-700: #007aff;
    --accent-50: #eef6ff;
    --surface-2: #f8fafc;
    --radius: 14px;
  }
  body[data-theme="cupertino"] .hero {
    background: linear-gradient(180deg, #eef6ff, #ffffff);
  }
  body[data-theme="cupertino"] .hero::before {
    content: "";
    position: absolute;
    inset: 0;
    background:
      radial-gradient(60% 80% at 50% 0%, rgba(10,132,255,0.18), transparent 60%),
      linear-gradient(180deg, transparent 0%, rgba(255,255,255,0.85) 100%);
    pointer-events: none;
  }
  body[data-theme="cupertino"] .nav__inner,
  body[data-theme="cupertino"] .search__fieldset,
  body[data-theme="cupertino"] .event-card,
  body[data-theme="cupertino"] .cta__inner,
  body[data-theme="cupertino"] .about__inner {
    background: rgba(255,255,255,0.75);
    border-color: rgba(255,255,255,0.6);
  }
}
